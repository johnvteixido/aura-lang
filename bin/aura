#!/usr/bin/env ruby

require "aura"

if ARGV.empty?
  puts <<~WELCOME
    ğŸŒŸ Welcome to Aura v0.1 ğŸŒŸ
    A forgiving, human-friendly language for AI and fast web apps.

    Usage:
      aura run examples/mnist_classifier.aura  # Run an Aura file
  WELCOME
  exit
end

command = ARGV[0]
filename = ARGV[1]

case command
when "run"
  if filename && File.exist?(filename)
    Aura.run_file(filename)
  else
    puts "ğŸ˜” File not found: #{filename}."
    puts "Creating a basic template for you! ğŸŒŸ"
    File.write(filename, <<~AURA)
      model greeter neural_network do
        input text
        output greeting "Hello from Aura! ğŸŒŸ"
      end

      route "/hello" get do
        output prediction from greeter.predict(input) format :json
      end

      run web on port: 3000
    AURA
    puts "âœ… Created #{filename}. Run 'aura run #{filename}' to start it."
  end
when "--help", "-h", "help"
  puts <<~HELP
    ğŸŒŸ Aura v0.1 CLI ğŸŒŸ
    Usage:
      aura run <file.aura>  - Parse, transpile, and execute script.
      aura repl             - Start an interactive Aura REPL session.
      aura --help           - Display this help message.
  HELP
when "repl"
  puts "ğŸŒŸ Interactive REPL mode is a planned feature on the roadmap (v0.3)! Stay tuned."
else
  puts "ğŸ˜” Unknown command: #{command}. Try 'aura --help'."
end
